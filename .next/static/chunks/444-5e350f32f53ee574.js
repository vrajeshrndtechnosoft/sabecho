"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[444],{682:(e,s,a)=>{a.r(s),a.d(s,{default:()=>C});var t=a(5155),r=a(2115),l=a(5695),o=a(3478),n=a(6474),i=a(3999);function d(e){let{...s}=e;return(0,t.jsx)(o.bL,{"data-slot":"accordion",...s})}function c(e){let{className:s,...a}=e;return(0,t.jsx)(o.q7,{"data-slot":"accordion-item",className:(0,i.cn)("border-b last:border-b-0",s),...a})}function m(e){let{className:s,children:a,...r}=e;return(0,t.jsx)(o.Y9,{className:"flex",children:(0,t.jsxs)(o.l9,{"data-slot":"accordion-trigger",className:(0,i.cn)("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",s),...r,children:[a,(0,t.jsx)(n.A,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function u(e){let{className:s,children:a,...r}=e;return(0,t.jsx)(o.UC,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...r,children:(0,t.jsx)("div",{className:(0,i.cn)("pt-0 pb-4",s),children:a})})}var x=a(9852),h=a(8482),p=a(7924),g=a(3052),b=a(1976),f=a(4783),j=a(7168),v=a(9840),y=a(8937),N=a(6671);let w=a(9509).env.API_URL||"http://localhost:3033",C=e=>{let{category:s,subcategory:a,product:o,location:n}=e,i=(0,l.useRouter)(),[C,_]=(0,r.useState)([]),[k,A]=(0,r.useState)(!0),[S,L]=(0,r.useState)(""),[I,R]=(0,r.useState)(""),[P,E]=(0,r.useState)(null),[z,F]=(0,r.useState)(""),[T,U]=(0,r.useState)(""),[q,O]=(0,r.useState)("categories"),[$,D]=(0,r.useState)(!1),[G,B]=(0,r.useState)([]),[J,M]=(0,r.useState)({isAuthenticated:!1}),V=(0,r.useCallback)(e=>{var s;let a="; ".concat(document.cookie).split("; ".concat(e,"="));return 2===a.length&&(null==(s=a.pop())?void 0:s.split(";").shift())||null},[]),W=(0,r.useCallback)(async()=>{let e=V("token");if(!e)return void M({isAuthenticated:!1});try{let s=await fetch("".concat(w,"/api/v1/verifyToken"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(s.ok){let e=await s.json();M({isAuthenticated:!0,userId:e.userId,email:e.email})}else M({isAuthenticated:!1}),N.oR.error("Session expired. Please log in again.")}catch(e){console.error("Error verifying user:",e),M({isAuthenticated:!1}),N.oR.error("Failed to verify user. Please try again.")}},[V]),Z=(0,r.useCallback)(async()=>{A(!0);try{let e=await fetch("".concat(w,"/api/v1/categories/all"),{credentials:"include"});if(!e.ok)throw Error("Failed to fetch categories");let s=(await e.json()).map(e=>({...e,subCategory:e.subCategory.map(e=>({...e,product:e.product.map(e=>({...e,description:"".concat(e.description||"No description available"),brands:"".concat(e.brands||"No brands specified")}))}))}));_(s)}catch(e){console.error("Error fetching categories:",e),N.oR.error("Failed to load categories. Please try again.")}finally{A(!1)}},[]),H=(0,r.useCallback)(async e=>{let s=V("token");if(s)try{let a=await fetch("".concat(w,"/api/v1/favorite/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to fetch favorites")}let t=await a.json();B(t.map(e=>e.productId))}catch(e){console.error("Error fetching favorites:",e),N.oR.error(e instanceof Error?e.message:"Failed to load favorites. Please try again.")}},[V]),Y=(0,r.useCallback)(async(e,s)=>{if(!J.isAuthenticated||!J.userId||!J.email)return void N.oR.error("Login Required",{description:"Please log in to add items to your favorites."});let a=G.includes(e);try{let t=V("token");if(!t)throw Error("Authentication token not found");let r=await fetch("".concat(w,"/api/v1/favorite/save"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:J.userId,productId:e,productName:s,email:J.email})});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to toggle favorite")}B(s=>a?s.filter(s=>s!==e):[...s,e]),N.oR.success(a?"Removed from favorites":"Added to favorites")}catch(e){console.error("Error toggling favorite:",e),N.oR.error(e instanceof Error?e.message:"Failed to update favorites. Please try again.")}},[J.isAuthenticated,J.userId,J.email,G,V]);(0,r.useEffect)(()=>{W(),Z()},[W,Z]),(0,r.useEffect)(()=>{J.isAuthenticated&&J.userId?H(J.userId):B([])},[J.isAuthenticated,J.userId,H]),(0,r.useEffect)(()=>{if(C.length>0){let e,t,r="";s&&(e=C.find(e=>e.category.toLowerCase()===s.toLowerCase()))&&(r=e._id),e&&a&&(t=e.subCategory.find(e=>e.name.toLowerCase()===a.toLowerCase())),s?o?(O("product"),F(o),E(t||null),U(r),n&&R(n)):(a?(O("subcategory"),E(t||null),U(r)):(O("categories"),U(r),E(null)),F("")):(O("categories"),U(""),E(null),F(""))}},[s,a,o,n,C]);let K=C.filter(e=>e.category.toLowerCase().includes(S.toLowerCase())),Q=(null==P?void 0:P.product.filter(e=>!I||e.p_name.toLowerCase().includes(I.toLowerCase())||e.location.toLowerCase().includes(I.toLowerCase())))||[],X=(0,r.useCallback)((e,s)=>{i.push("/products/".concat(encodeURIComponent(s),"/").concat(encodeURIComponent(e.name))),E(e),F(""),O("subcategory"),R(""),D(!1)},[i]),ee=(0,r.useCallback)((e,s)=>{i.push("/products/".concat(encodeURIComponent(s),"/").concat(encodeURIComponent((null==P?void 0:P.name)||""),"/").concat(encodeURIComponent(e.p_name))),F(e.p_name),O("product"),D(!1)},[i,P]),es=(0,r.useCallback)(()=>{i.push("/products"),O("categories"),E(null),F(""),U(""),D(!1)},[i]),ea=(0,r.useCallback)(()=>{if(P){var e;let s=(null==(e=C.find(e=>e.subCategory.some(e=>e._id===P._id)))?void 0:e.category)||"";i.push("/products/".concat(encodeURIComponent(s),"/").concat(encodeURIComponent(P.name))),O("subcategory"),F(""),D(!1)}},[i,P,C]);if(k)return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-6",children:(0,t.jsx)("div",{className:"container mx-auto px-4",children:(0,t.jsx)("div",{className:"w-48 h-8 bg-white/20 rounded animate-pulse"})})}),(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,t.jsx)("div",{className:"w-full h-10 bg-gray-200 rounded-md mb-4 animate-pulse"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"w-full h-6 bg-gray-200 rounded-md animate-pulse"}),(0,t.jsx)("div",{className:"w-full h-6 bg-gray-200 rounded-md animate-pulse"}),(0,t.jsx)("div",{className:"w-full h-6 bg-gray-200 rounded-md animate-pulse"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,t.jsx)("div",{className:"w-48 h-8 bg-gray-200 rounded-md mb-4 animate-pulse"}),(0,t.jsx)("div",{className:"w-full h-10 bg-gray-200 rounded-md mb-4 animate-pulse"}),(0,t.jsx)("div",{className:"w-full h-48 bg-gray-200 rounded-md animate-pulse"})]})]})]});let et=(e,s)=>(0,t.jsxs)("tr",{className:"border-b hover:bg-gray-50 ".concat(o===e.p_name&&n===e.location?"bg-blue-50":""),children:[(0,t.jsx)("td",{className:"p-2 md:p-3 font-medium text-sm",children:e.p_name}),(0,t.jsx)("td",{className:"p-2 md:p-3 text-sm",children:e.location}),(0,t.jsx)("td",{className:"p-2 md:p-3 text-sm",children:e.brands}),(0,t.jsxs)("td",{className:"p-2 md:p-3 flex space-x-2",children:[(0,t.jsx)(j.$,{variant:"outline",size:"sm",onClick:()=>Y(e._id,e.p_name),className:"".concat(G.includes(e._id)?"text-red-600 border-red-600 hover:bg-red-50":"text-gray-600 border-gray-300 hover:bg-gray-50"," h-8 w-8 p-0"),"aria-label":G.includes(e._id)?"Remove from favorites":"Add to favorites",children:(0,t.jsx)(b.A,{className:"w-4 h-4 ".concat(G.includes(e._id)?"fill-current":"")})}),(0,t.jsxs)(v.lG,{children:[(0,t.jsx)(v.zM,{asChild:!0,children:(0,t.jsx)(j.$,{variant:"outline",size:"sm",className:"text-blue-600 border-blue-600 hover:bg-blue-50 h-8 text-xs",children:"Send Inquiry"})}),(0,t.jsxs)(v.Cf,{className:"p-0 max-w-[90vw] w-full sm:max-w-md md:max-w-3xl rounded-lg",children:[(0,t.jsxs)(v.L3,{className:"mt-5 px-5",children:["Inquiry for ",e.p_name]}),(0,t.jsx)(y.A,{initialProduct:{_id:e._id,location:e.location,categoryType:s,categorySubType:(null==P?void 0:P.name)||"",name:e.p_name,measurementOptions:["pieces","dozens","boxes"],p_name:e.p_name,brand:e.brands}})]})]})]})]},e._id),er=(e,s)=>(0,t.jsx)("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Product: "}),(0,t.jsx)("span",{className:"text-sm",children:e.p_name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Location: "}),(0,t.jsx)("span",{className:"text-sm",children:e.location})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Description: "}),"` ",(0,t.jsx)("span",{className:"text-sm",children:e.description||"No description available"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 pt-2",children:[(0,t.jsx)(j.$,{variant:"outline",size:"sm",onClick:()=>Y(e._id,e.p_name),className:"".concat(G.includes(e._id)?"text-red-600 border-red-blue-gray-50":"text-gray-600 border-gray-300 hover:bg-gray-50"," h-8 w-8 p-0"),"aria-label":G.includes(e._id)?"Remove from favorites":"Add to favorites",children:(0,t.jsx)(b.A,{className:"w-4 h-4 ".concat(G.includes(e._id)?"fill-current":"")})}),(0,t.jsxs)(v.lG,{children:[(0,t.jsx)(v.zM,{asChild:!0,children:(0,t.jsx)(j.$,{variant:"outline",size:"sm",className:"text-blue-600 border-blue-600 hover:bg-blue-50 h-8 text-xs",children:"Send Inquiry"})}),(0,t.jsxs)(v.Cf,{className:"p-0 max-w-[90vw] w-full sm:max-w-md rounded-lg",children:[(0,t.jsxs)(v.L3,{className:"mt-5 px-5",children:["Inquiry for ",e.p_name]}),(0,t.jsx)(y.A,{initialProduct:{_id:e._id,location:e.location,categoryType:s,categorySubType:(null==P?void 0:P.name)||"",name:e.p_name,measurementOptions:["pieces","dozens","boxes"],p_name:e.p_name,brand:e.brands}})]})]})]})]})},e._id);return(0,t.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,t.jsxs)("div",{className:"md:min-h flex items-center justify-between mb-4 md:min",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Product Categories"}),(0,t.jsx)(j.$,{variant:"outline",size:"icon",onClick:()=>D(!$),className:"text-gray-700 border-gray-300","aria-label":$?"Hide categories":"Show categories"}),(0,t.jsx)(f.A,{className:"w-5 h-5"})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,t.jsx)("div",{className:"w-full md:w-1/4 transition-all duration-300 ".concat($?"block":"hidden md:block"," \n            }"),children:(0,t.jsx)(h.Zp,{className:"shadow-md",children:(0,t.jsxs)(h.Wu,{className:"p-4",children:[(0,t.jsx)("h2",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4 hidden md:block",children:"Product Categories"}),(0,t.jsxs)("div",{className:"relative mb-4",children:[(0,t.jsx)(p.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"}),(0,t.jsx)(x.p,{placeholder:"Search categories...",value:S,onChange:e=>L(e.target.value),className:"pl-9 h-9 text-sm md:pl-10 md:h-10 md:text-base border-gray-300 focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsx)(d,{type:"single",collapsible:!0,value:T,onValueChange:U,className:"space-y-1",children:K.map(e=>(0,t.jsxs)(c,{value:e._id,children:[(0,t.jsx)(m,{className:"text-gray-900 font-medium hover:text-blue-600 text-sm md:text-base py-2",children:e.category}),(0,t.jsx)(u,{children:(0,t.jsx)("div",{className:"space-y-1 pl-3 md:pl-4",children:e.subCategory.map(s=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("button",{onClick:()=>X(s,e.category),className:"flex items-center w-full text-left text-gray-700 hover:text-blue-600 transition-colors mb-1 text-sm md:text-base ".concat((null==P?void 0:P._id)===s._id?"text-blue-600 font-semibold":""),children:[(0,t.jsx)(g.A,{className:"w-3 h-3 md:w-4 md:h-4 mr-2"}),s.name," (",s.product.length,")"]}),(null==P?void 0:P._id)===s._id&&(0,t.jsx)("div",{className:"ml-4 md:ml-6 space-y-1",children:s.product.map(s=>(0,t.jsxs)("button",{onClick:()=>ee(s,e.category),className:"block w-full text-left text-xs md:text-sm text-gray-600 hover:text-blue-500 transition-colors py-1 px-2 rounded ".concat(z.toLowerCase()===s.p_name.toLowerCase()?"bg-blue-50 text-blue-600 font-medium":"hover:bg-gray-50"),children:["• ",s.p_name]},s._id))})]},s._id))})})]},e._id))})]})})}),(0,t.jsx)("div",{className:"w-full md:w-3/4",children:(0,t.jsx)(h.Zp,{className:"shadow-md",children:(0,t.jsxs)(h.Wu,{className:"p-4 md:p-6",children:[(0,t.jsxs)("div",{className:"flex items-center text-xs md:text-sm text-gray-600 mb-4 flex-wrap",children:[(0,t.jsx)("button",{onClick:es,className:"hover:text-blue-600 transition-colors",children:"Categories"}),P&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.A,{className:"w-3 h-3 md:w-4 md:h-4 mx-2"}),(0,t.jsx)("button",{onClick:ea,className:"hover:text-blue-600 transition-colors",children:P.name})]}),z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.A,{className:"w-3 h-3 md:w-4 md:h-4 mx-2"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium",children:z})]})]}),"categories"===q&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4",children:"All Categories"}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:K.map(e=>(0,t.jsxs)("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 text-sm md:text-base mb-2",children:e.category}),(0,t.jsxs)("p",{className:"text-xs md:text-sm text-gray-600 mb-3",children:[e.subCategory.length," subcategories"]}),(0,t.jsx)(j.$,{variant:"outline",size:"sm",onClick:()=>U(e._id),className:"text-blue-600 border-blue-600 hover:bg-blue-50 text-xs md:text-sm px-3 h-8",children:"View Subcategories"})]},e._id))})]}),"subcategory"===q&&(P?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h2",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4",children:[P.name," Products"]}),(0,t.jsxs)("div",{className:"relative mb-4",children:[(0,t.jsx)(p.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"}),(0,t.jsx)(x.p,{placeholder:"Search products or locations...",value:I,onChange:e=>R(e.target.value),className:"pl-9 h-9 text-sm md:pl-10 md:h-10 md:text-base border-gray-300 focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-100 text-gray-700 uppercase text-xs",children:[(0,t.jsx)("th",{className:"p-3",children:"Product"}),(0,t.jsx)("th",{className:"p-3",children:"Location"}),(0,t.jsx)("th",{className:"p-3",children:"Description"}),(0,t.jsx)("th",{className:"p-3",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:Q.length>0?Q.map(e=>{var s;return et(e,(null==(s=C.find(e=>e.subCategory.some(e=>e._id===P._id)))?void 0:s.category)||"")}):(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:4,className:"p-3 text-center text-gray-500 text-sm",children:"No products found."})})})]})}),(0,t.jsx)("div",{className:"md:hidden space-y-3",children:Q.length>0?Q.map(e=>{var s;return er(e,(null==(s=C.find(e=>e.subCategory.some(e=>e._id===P._id)))?void 0:s.category)||"")}):(0,t.jsx)("div",{className:"p-4 text-gray-500 text-sm text-center",children:"No products found."})})]}):(0,t.jsx)("div",{className:"p-4 text-gray-500 text-sm text-center",children:"Subcategory not found."})),"product"===q&&(()=>{if(!P||!z)return(0,t.jsx)("div",{className:"p-4 text-gray-500 text-sm text-center",children:"Product not found."});let e=P.product.filter(e=>e.p_name.toLowerCase()===z.toLowerCase()&&(""===I||e.location.toLowerCase().includes(I.toLowerCase())));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h2",{className:"text-base md:text-lg font-semibold text-gray-900 mb-4",children:[z," - All Locations"]}),(0,t.jsxs)("div",{className:"relative mb-4",children:[(0,t.jsx)(p.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 md:w-5 md:h-5"}),(0,t.jsx)(x.p,{placeholder:"Search locations...",value:I,onChange:e=>R(e.target.value),className:"pl-9 h-9 text-sm md:pl-10 md:h-md:text-md border-base border-gray-300 focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-100 text-gray-700 uppercase text-xs",children:[(0,t.jsx)("th",{className:"p-p-2 md:p-3",children:"Product Name"}),(0,t.jsx)("th",{className:"p-2 p md:p-3",children:"Location"}),(0,t.jsx)("th",{className:"p-2 p md:p-3",children:"Description"}),(0,t.jsx)("th",{className:"p-2 p-p-md:p-3",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:e.length>0?e.map(e=>{var s;return et(e,(null==(s=C.find(e=>e.subCategory.some(e=>e._id===P._id)))?void 0:s.category)||"")}):(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:4,className:"p-2 md:p-3 text-center text-gray-500 text-sm",children:"No locations found for this product."})})})]})}),(0,t.jsx)("div",{className:"space-y-3 md:hidden",children:e.length>0?e.map(e=>{var s;return er(e,(null==(s=C.find(e=>e.subCategory.some(e=>e._id===P._id)))?void 0:s.category)||"")}):(0,t.jsx)("div",{className:"p-4 text-gray-500 text-sm text-center",children:"No locations found for this product."})})]})})()]})})})]})]})})}}}]);