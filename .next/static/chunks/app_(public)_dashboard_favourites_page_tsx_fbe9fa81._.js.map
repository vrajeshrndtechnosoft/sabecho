{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Keval/VrajeshRndTechnosoft/sabecho-v2/app/%28public%29/dashboard/favourites/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { Heart, Trash2, Loader2, AlertCircle } from \"lucide-react\"\r\nimport Image from \"next/image\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Label } from \"@/components/ui/label\"\r\n\r\ninterface TokenResponse {\r\n  email: string\r\n  exp: number\r\n  iat: number\r\n  userId: string\r\n  userType: string\r\n}\r\n\r\ninterface FavoriteItem {\r\n  _id: string\r\n  name: string\r\n  description: string\r\n  image?: string\r\n}\r\n\r\ninterface ErrorResponse {\r\n  error: string\r\n}\r\n\r\nconst FavouritesComponent: React.FC = () => {\r\n  const [favorites, setFavorites] = useState<FavoriteItem[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const API_URL = process.env.API_URL || \"http://localhost:3033\"\r\n\r\n  useEffect(() => {\r\n    fetchFavorites()\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [])\r\n\r\n  const getCookie = (name: string): string | null => {\r\n    const value = `; ${document.cookie}`\r\n    const parts = value.split(`; ${name}=`)\r\n    if (parts.length === 2) return parts.pop()?.split(\";\").shift() || null\r\n    return null\r\n  }\r\n\r\n  const fetchFavorites = async () => {\r\n    try {\r\n      setLoading(true)\r\n      setError(null)\r\n\r\n      // Get token from cookie\r\n      const token = getCookie(\"token\")\r\n      if (!token) {\r\n        throw new Error(\"No authentication token found\")\r\n      }\r\n\r\n      // Verify token\r\n      const tokenResponse = await fetch(`${API_URL}/api/v1/verifyToken`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ token }),\r\n      })\r\n\r\n      if (!tokenResponse.ok) {\r\n        throw new Error(\"Token verification failed\")\r\n      }\r\n\r\n      const tokenData: TokenResponse = await tokenResponse.json()\r\n      const userId = tokenData.userId\r\n\r\n      // Fetch favorites\r\n      const favoritesResponse = await fetch(`${API_URL}/api/v1/favorites/matched/${userId}`, {\r\n        method: \"GET\",\r\n        headers: {\r\n          \"Authorization\": `Bearer ${token}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      })\r\n\r\n      if (!favoritesResponse.ok) {\r\n        // Parse the error response\r\n        const errorData: ErrorResponse = await favoritesResponse.json()\r\n        if (favoritesResponse.status === 404 && errorData.error === \"Favorites not found\") {\r\n          setFavorites([]) // Show \"No favorites\" UI\r\n          return\r\n        }\r\n        throw new Error(errorData.error || \"Failed to fetch favorites\")\r\n      }\r\n\r\n      const favoritesData: FavoriteItem[] = await favoritesResponse.json()\r\n      setFavorites(favoritesData)\r\n\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : \"An error occurred\")\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleRemoveFavorite = async (itemId: string) => {\r\n    try {\r\n      const token = getCookie(\"token\")\r\n      if (!token) {\r\n        throw new Error(\"No authentication token found\")\r\n      }\r\n\r\n      // Mock API call to remove favorite (adjust endpoint as needed)\r\n      const response = await fetch(`${API_URL}/api/v1/favorites/remove/${itemId}`, {\r\n        method: \"DELETE\",\r\n        headers: {\r\n          \"Authorization\": `Bearer ${token}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      })\r\n\r\n      if (!response.ok) {\r\n        throw new Error(\"Failed to remove favorite\")\r\n      }\r\n\r\n      // Update state to remove the item locally\r\n      setFavorites(favorites.filter((item) => item._id !== itemId))\r\n\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : \"An error occurred while removing favorite\")\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-64\">\r\n        <div className=\"flex items-center space-x-2 text-blue-600\">\r\n          <Loader2 className=\"animate-spin\" size={24} />\r\n          <span className=\"text-lg\">Loading favorites...</span>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-64\">\r\n        <div className=\"flex items-center space-x-2 text-red-600 bg-red-50 p-4 rounded-lg\">\r\n          <AlertCircle size={24} />\r\n          <span className=\"text-lg\">{error}</span>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 sm:px-6 py-6\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-2 flex items-center\">\r\n          My Favorites\r\n        </h1>\r\n        <Label className=\"font-light text-gray-500 mb-6\">\r\n            Manage your favorite items\r\n        </Label>\r\n\r\n        {favorites.length === 0 ? (\r\n          <div className=\"text-center text-gray-500 py-12\">\r\n            <Heart className=\"mx-auto mb-4 text-gray-400\" size={48} />\r\n            <p className=\"text-lg\">You havenâ€™t added any favorites yet.</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            {favorites.map((item) => (\r\n              <div key={item._id} className=\"bg-white rounded-lg shadow-sm border p-6 flex flex-col\">\r\n                {/* Item Image */}\r\n                <div className=\"relative h-40 mb-4\">\r\n                  {item.image ? (\r\n                    <Image\r\n                      src={`${API_URL}/uploads/${item.image}`}\r\n                      alt={item.name}\r\n                      layout=\"fill\"\r\n                      objectFit=\"cover\"\r\n                      className=\"rounded-md\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"h-full w-full bg-gray-100 rounded-md flex items-center justify-center\">\r\n                      <span className=\"text-gray-400\">No Image</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Item Details */}\r\n                <h2 className=\"text-lg font-semibold text-gray-900 mb-2\">{item.name}</h2>\r\n                <p className=\"text-sm text-gray-600 flex-1\">{item.description}</p>\r\n\r\n                {/* Remove Button */}\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"mt-4 text-red-600 border-red-500 hover:bg-red-50\"\r\n                  onClick={() => handleRemoveFavorite(item._id)}\r\n                >\r\n                  <Trash2 className=\"mr-2 h-4 w-4\" />\r\n                  Remove\r\n                </Button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default FavouritesComponent"],"names":[],"mappings":"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","debugId":null}}]
}